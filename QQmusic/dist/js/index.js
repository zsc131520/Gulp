var len,control,root=window.player,dataList=[],audio=root.audioManager,timer=null;function getData(t){$.ajax({type:"GET",url:t,datatype:"json",success:function(t){len=t.length,control=new root.controlIndex(len),dataList=t,bindEvent(),bindTouch(),root.playList.renderList(t),$("body").trigger("playChange",0)},error:function(){console.log("请重试，感谢支持")}})}function bindEvent(){$("body").on("playChange",function(t,o){root.render(dataList[o]),root.pro.renderAllTime(dataList[o].duration),audio.getAudio(dataList[o].audio),"play"==audio.status&&(audio.play(),rotated(0)),$(".img_box").attr("data-deg",0),$(".img_box").css({transform:"rotateZ(0deg)",transition:"none"})}),$(".prev").on("click",function(){var t=control.prev();$("body").trigger("playChange",t),root.pro.start(0),"pause"==audio.status&&root.pro.stop()}),$(".next").on("click",function(){var t=control.next();$("body").trigger("playChange",t),root.pro.start(0),"pause"==audio.status&&root.pro.stop()}),$(".play").on("click",function(){"pause"==audio.status?(audio.play(),root.pro.start(),rotated($(".img_box").attr("data-deg")||0)):(audio.pause(),root.pro.stop(),clearInterval(timer));$(".play").toggleClass("playing")}),$(".list").on("click",function(){root.playList.show(control)}),$(".like").on("click",function(){var t=control.index;dataList[t].isLike?($(this).removeClass("liking"),dataList[t].isLike=!1):($(this).addClass("liking"),dataList[t].isLike=!0)})}function bindTouch(){var t=$(".dot"),o=$(".pro-bottom").offset(),n=o.left,i=o.width;t.on("touchstart",function(t){root.pro.stop()}).on("touchmove",function(t){var o=(t.changedTouches[0].clientX-n)/i;0<=o&&o<1&&root.pro.update(o)}).on("touchend",function(t){var o=(t.changedTouches[0].clientX-n)/i;if(0<=o&&o<1){var a=o*dataList[control.index].duration;root.pro.start(o),audio.playTo(a),audio.play(),audio.status="play",$(".play").addClass("playing")}})}function rotated(t){t=+t,clearInterval(timer),timer=setInterval(function(){t+=2,$(".img_box").attr("data-deg",t),$(".img_box").css({transform:"rotateZ("+t+"deg)",transition:"all .2s linear"})},200)}getData("../mock/data.json");